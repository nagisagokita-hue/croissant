<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‰∏ñÁïå„ÅÆ„ÇØ„É≠„ÉØ„ÉÉ„Çµ„É≥„Éû„ÉÉ„Éó</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; margin: 0; padding: 0; }
        .map-container svg { filter: drop-shadow(0 10px 15px rgba(0,0,0,0.1)); }
    </style>
</head>
<body class="bg-orange-50">
    <div id="root"></div>

    <script type="text/babel">
        // React„Å®Lucide„ÇíÂÆâÂÖ®„Å´ÂèñÂæó
        const { useState, useEffect } = React;

        const WORLD_PATHS = [
            { name: 'North America', d: "M 150 100 L 180 80 L 250 85 L 320 120 L 330 200 L 280 230 L 200 210 L 140 150 Z" },
            { name: 'South America', d: "M 280 260 L 330 280 L 340 330 L 300 420 L 260 380 L 250 300 Z" },
            { name: 'Europe', d: "M 480 120 L 530 110 L 550 140 L 530 180 L 480 170 L 470 140 Z" },
            { name: 'Africa', d: "M 470 190 L 530 180 L 560 230 L 540 330 L 480 340 L 450 250 Z" },
            { name: 'Asia', d: "M 550 120 L 700 80 L 850 130 L 880 250 L 750 300 L 600 280 L 540 200 Z" },
            { name: 'Australia', d: "M 780 330 L 850 320 L 870 380 L 800 410 L 760 370 Z" },
            { name: 'Japan', d: "M 835 155 L 845 155 L 850 170 L 840 180 Z" }
        ];

        const CroissantMap = () => {
            const [croissants, setCroissants] = useState([
                { id: '1', shopName: 'Sample Bakery', location: 'Paris', rating: 5, comment: '„Çµ„ÇØ„Çµ„ÇØ„ÅßÊúÄÈ´òÔºÅ', lat: 48.8566, lng: 2.3522 }
            ]);
            const [viewMode, setViewMode] = useState('grid');
            const [showForm, setShowForm] = useState(false);
            const [formData, setFormData] = useState({ shopName: '', location: '', rating: 5, comment: '', lat: 35.6762, lng: 139.6503 });

            // Â∫ßÊ®ôÂ§âÊèõ
            const getCoords = (lat, lng) => ({
                x: ((lng + 180) / 360) * 1000,
                y: ((90 - lat) / 180) * 500
            });

            // Âú∞Âõ≥„ÇØ„É™„ÉÉ„ÇØ„ÅßÂ†¥ÊâÄÈÅ∏Êäû
            const handleMapClick = (e) => {
                const rect = e.currentTarget.getBoundingClientRect();
                const x = ((e.clientX - rect.left) / rect.width) * 1000;
                const y = ((e.clientY - rect.top) / rect.height) * 500;
                setFormData({ 
                    ...formData, 
                    lng: (x / 1000) * 360 - 180, 
                    lat: 90 - (y / 500) * 180 
                });
            };

            // „Ç¢„Ç§„Ç≥„É≥„ÇíÂÜçÊèèÁîª„Åô„ÇãÂëΩ‰ª§
            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [viewMode, showForm, formData.rating]);

            return (
                <div className="min-h-screen pb-10">
                    <header className="bg-amber-600 text-white p-6 shadow-xl flex justify-between items-center">
                        <h1 className="text-2xl font-black tracking-tighter italic">ü•ê CROISSANT WORLD</h1>
                        <button 
                            onClick={() => setShowForm(true)} 
                            className="bg-white text-amber-600 px-6 py-2 rounded-full font-bold shadow-md hover:scale-105 transition active:scale-95"
                        >
                            ÊäïÁ®ø„Åô„Çã
                        </button>
                    </header>

                    <div className="max-w-6xl mx-auto p-6">
                        <div className="flex gap-2 mb-8 bg-amber-100 w-fit p-1 rounded-2xl shadow-inner border border-amber-200">
                            <button 
                                onClick={() => setViewMode('grid')} 
                                className={`px-6 py-2 rounded-xl font-bold transition ${viewMode === 'grid' ? 'bg-white text-amber-600 shadow-sm' : 'text-amber-800/50 hover:text-amber-700'}`}
                            >
                                ‰∏ÄË¶ßË°®Á§∫
                            </button>
                            <button 
                                onClick={() => setViewMode('map')} 
                                className={`px-6 py-2 rounded-xl font-bold transition ${viewMode === 'map' ? 'bg-white text-amber-600 shadow-sm' : 'text-amber-800/50 hover:text-amber-700'}`}
                            >
                                „Éû„ÉÉ„Éó
                            </button>
                        </div>

                        {viewMode === 'grid' ? (
                            <div className="grid md:grid-cols-3 gap-6 animate-in fade-in duration-500">
                                {croissants.map(c => (
                                    <div key={c.id} className="bg-white p-6 rounded-3xl shadow-sm border border-amber-100 hover:shadow-xl transition-all">
                                        <h3 className="text-xl font-black text-amber-900 mb-1">{c.shopName}</h3>
                                        <div className="text-amber-600 text-xs font-bold flex items-center gap-1 mb-4 uppercase tracking-widest">
                                            <i data-lucide="map-pin" className="w-3 h-3"></i> {c.location}
                                        </div>
                                        <div className="flex gap-1 mb-4">
                                            {[...Array(5)].map((_, i) => (
                                                <i key={i} data-lucide="star" className={`w-4 h-4 ${i < c.rating ? 'fill-amber-400 text-amber-400' : 'text-gray-200'}`}></i>
                                            ))}
                                        </div>
                                        <p className="text-slate-600 leading-relaxed italic border-l-4 border-amber-100 pl-4">"{c.comment}"</p>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <div className="bg-sky-100 rounded-[2rem] p-6 border-8 border-white shadow-2xl aspect-[2/1] relative overflow-hidden map-container">
                                <svg viewBox="0 0 1000 500" className="w-full h-full drop-shadow-lg">
                                    {WORLD_PATHS.map((p, i) => (
                                        <path key={i} d={p.d} fill="#e2f5d3" stroke="#94d6a1" strokeWidth="1.5" />
                                    ))}
                                    {croissants.map(c => {
                                        const {x, y} = getCoords(c.lat, c.lng);
                                        return (
                                            <g key={c.id}>
                                                <circle cx={x} cy={y} r="12" fill="white" fillOpacity="0.4" className="animate-ping" />
                                                <circle cx={x} cy={y} r="6" fill="#d97706" stroke="white" strokeWidth="2" />
                                            </g>
                                        );
                                    })}
                                </svg>
                                <div className="absolute bottom-6 right-6 bg-white/80 backdrop-blur px-4 py-2 rounded-full text-[10px] font-bold text-sky-800 border border-sky-200 shadow-sm">
                                    ‰∏ñÁïåÂêÑÂú∞„ÅÆ„ÇØ„É≠„ÉØ„ÉÉ„Çµ„É≥„Åå„Åì„Åì„Å´ÈõÜÁµê
                                </div>
                            </div>
                        )}
                    </div>

                    {showForm && (
                        <div className="fixed inset-0 bg-slate-900/70 backdrop-blur-md z-50 flex items-center justify-center p-4">
                            <div className="bg-white rounded-[2.5rem] max-w-2xl w-full flex flex-col md:flex-row overflow-hidden shadow-2xl border border-white/20 animate-in zoom-in-95 duration-300">
                                <div className="md:w-1/2 bg-sky-50 p-8 border-r border-slate-100 flex flex-col justify-center">
                                    <h3 className="text-sm font-black text-sky-800 mb-4 flex items-center gap-2">
                                        <i data-lucide="navigation" className="w-4 h-4"></i> Âú∞Âõ≥„Çí„Çø„ÉÉ„Éó„Åó„Å¶Â†¥ÊâÄ„ÇíÈÅ∏Êäû
                                    </h3>
                                    <div className="bg-sky-100 rounded-2xl p-2 shadow-inner border-2 border-sky-200">
                                        <svg viewBox="0 0 1000 500" className="w-full cursor-crosshair" onClick={handleMapClick}>
                                            {WORLD_PATHS.map((p, i) => <path key={i} d={p.d} fill="white" stroke="#cbd5e1" />)}
                                            <circle cx={getCoords(formData.lat, formData.lng).x} cy={getCoords(formData.lat, formData.lng).y} r="12" fill="#f59e0b" stroke="white" strokeWidth="3" />
                                        </svg>
                                    </div>
                                    <p className="text-[10px] text-slate-400 mt-4 text-center">„Éî„É≥„ÅÆÂ†¥ÊâÄ„ÅåÊäïÁ®ø‰ΩçÁΩÆ„Å´„Å™„Çä„Åæ„Åô</p>
                                </div>
                                <div className="md:w-1/2 p-10 space-y-6">
                                    <div className="flex justify-between items-center">
                                        <h2 className="text-2xl font-black text-amber-900 italic tracking-tighter">NEW POST</h2>
                                        <button onClick={()=>setShowForm(false)} className="p-2 hover:bg-slate-100 rounded-full transition"><i data-lucide="x"></i></button>
                                    </div>
                                    <div className="space-y-4">
                                        <input 
                                            placeholder="„ÅäÂ∫ó„ÅÆÂêçÂâç" 
                                            className="w-full border-b-2 border-amber-100 p-2 outline-none font-bold text-xl focus:border-amber-500 transition placeholder:text-slate-300" 
                                            onChange={e => setFormData({...formData, shopName: e.target.value})} 
                                        />
                                        <input 
                                            placeholder="„Ç®„É™„Ç¢Âêç (‰æã: Paris, France)" 
                                            className="w-full border-b border-slate-200 p-2 text-sm outline-none focus:border-amber-500 transition" 
                                            onChange={e => setFormData({...formData, location: e.target.value})} 
                                        />
                                        <div className="flex items-center gap-2 py-2">
                                            {[1,2,3,4,5].map(s => (
                                                <button key={s} onClick={()=>setFormData({...formData, rating: s})} className="transition transform hover:scale-125">
                                                    <i data-lucide="star" className={`w-6 h-6 ${s <= formData.rating ? 'fill-amber-400 text-amber-400' : 'text-slate-200'}`}></i>
                                                </button>
                                            ))}
                                        </div>
                                        <textarea 
                                            placeholder="„ÇØ„É≠„ÉØ„ÉÉ„Çµ„É≥„ÅÆÊÑüÊÉ≥„ÇíËÅû„Åã„Åõ„Å¶ÔºÅ" 
                                            className="w-full bg-slate-50 rounded-2xl p-4 h-28 outline-none focus:ring-4 ring-amber-100 transition resize-none text-slate-700" 
                                            onChange={e => setFormData({...formData, comment: e.target.value})}
                                        ></textarea>
                                    </div>
                                    <button 
                                        onClick={() => { 
                                            if(!formData.shopName) return alert('Â∫óÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Å≠ÔºÅ');
                                            setCroissants([...croissants, {...formData, id: Date.now().toString()}]); 
                                            setShowForm(false); 
                                        }} 
                                        className="w-full bg-amber-600 text-white font-black py-5 rounded-2xl shadow-xl hover:bg-amber-700 transition transform hover:-translate-y-1 active:scale-95 shadow-amber-200"
                                    >
                                        „Éû„ÉÉ„Éó„Å´Âàª„ÇÄ ü•ê
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<CroissantMap />);
    </script>
</body>
</html>
